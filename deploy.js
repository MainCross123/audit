require('dotenv-safe').config()

const ethers = require('ethers')
const { PRIVATE_KEY } = process.env
const ccipAbi = [{"inputs":[{"internalType":"address","name":"_router","type":"address"},{"internalType":"address","name":"_link","type":"address"},{"internalType":"address","name":"_usdc","type":"address"},{"internalType":"address","name":"_v3Router","type":"address"},{"internalType":"address","name":"_v2Router","type":"address"},{"internalType":"uint256","name":"_swapFee","type":"uint256"},{"internalType":"address","name":"_feeReceiver","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"uint64","name":"destinationChainSelector","type":"uint64"}],"name":"DestinationChainNotAllowlisted","type":"error"},{"inputs":[],"name":"ErrorCase","type":"error"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"target","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"FailedToWithdrawEth","type":"error"},{"inputs":[],"name":"InvalidReceiverAddress","type":"error"},{"inputs":[{"internalType":"address","name":"router","type":"address"}],"name":"InvalidRouter","type":"error"},{"inputs":[{"internalType":"bytes32","name":"messageId","type":"bytes32"}],"name":"MessageNotFailed","type":"error"},{"inputs":[{"internalType":"uint256","name":"currentBalance","type":"uint256"},{"internalType":"uint256","name":"calculatedFees","type":"uint256"}],"name":"NotEnoughBalance","type":"error"},{"inputs":[],"name":"NothingToWithdraw","type":"error"},{"inputs":[],"name":"OnlySelf","type":"error"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"OwnableInvalidOwner","type":"error"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"OwnableUnauthorizedAccount","type":"error"},{"inputs":[{"internalType":"address","name":"sender","type":"address"}],"name":"SenderNotAllowed","type":"error"},{"inputs":[{"internalType":"uint64","name":"sourceChainSelector","type":"uint64"}],"name":"SourceChainNotAllowed","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"messageId","type":"bytes32"},{"indexed":false,"internalType":"bytes","name":"reason","type":"bytes"}],"name":"MessageFailed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"messageId","type":"bytes32"},{"indexed":true,"internalType":"uint64","name":"sourceChainSelector","type":"uint64"},{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"string","name":"text","type":"string"},{"indexed":false,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"tokenAmount","type":"uint256"}],"name":"MessageReceived","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"messageId","type":"bytes32"}],"name":"MessageRecovered","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"messageId","type":"bytes32"},{"indexed":true,"internalType":"uint64","name":"destinationChainSelector","type":"uint64"},{"indexed":false,"internalType":"address","name":"receiver","type":"address"},{"indexed":false,"internalType":"string","name":"text","type":"string"},{"indexed":false,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"tokenAmount","type":"uint256"},{"indexed":false,"internalType":"address","name":"feeToken","type":"address"},{"indexed":false,"internalType":"uint256","name":"fees","type":"uint256"}],"name":"MessageSent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"time","type":"uint256"}],"name":"TimeLockActivated","type":"event"},{"inputs":[],"name":"activateTimelock","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint64","name":"_destinationChainSelector","type":"uint64"},{"internalType":"bool","name":"allowed","type":"bool"}],"name":"allowlistDestinationChain","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_sender","type":"address"},{"internalType":"bool","name":"allowed","type":"bool"}],"name":"allowlistSender","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint64","name":"_sourceChainSelector","type":"uint64"},{"internalType":"bool","name":"allowed","type":"bool"}],"name":"allowlistSourceChain","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint64","name":"","type":"uint64"}],"name":"allowlistedDestinationChains","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"allowlistedSenders","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint64","name":"","type":"uint64"}],"name":"allowlistedSourceChains","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint64","name":"_destinationChainSelector","type":"uint64"},{"internalType":"address","name":"_receiver","type":"address"},{"internalType":"address","name":"_token","type":"address"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"uint256","name":"_gasLimitReceiver","type":"uint256"},{"internalType":"bool","name":"_payInLINK","type":"bool"},{"components":[{"internalType":"address","name":"finalToken","type":"address"},{"internalType":"address","name":"userReceiver","type":"address"},{"internalType":"uint256","name":"minAmountOut","type":"uint256"},{"internalType":"uint256","name":"minAmountOutV2Swap","type":"uint256"},{"internalType":"bool","name":"isV2","type":"bool"},{"internalType":"bool","name":"unwrapETH","type":"bool"},{"internalType":"bytes","name":"path","type":"bytes"},{"internalType":"address[]","name":"v2Path","type":"address[]"}],"internalType":"struct CCIP.ReceiverSwapData","name":"_receiverSwapData","type":"tuple"}],"name":"calculateFeeGas","outputs":[{"internalType":"uint256","name":"fees","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"messageId","type":"bytes32"},{"internalType":"uint64","name":"sourceChainSelector","type":"uint64"},{"internalType":"bytes","name":"sender","type":"bytes"},{"internalType":"bytes","name":"data","type":"bytes"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct Client.EVMTokenAmount[]","name":"destTokenAmounts","type":"tuple[]"}],"internalType":"struct Client.Any2EVMMessage","name":"any2EvmMessage","type":"tuple"}],"name":"ccipReceive","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_fee","type":"uint256"},{"internalType":"address","name":"_feeReceiver","type":"address"}],"name":"changeFeeAndAddress","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_v2Router","type":"address"},{"internalType":"address","name":"_v3Router","type":"address"}],"name":"changeRouters","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"failedMessageByMessageId","outputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"index","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"failedMessagesUsers","outputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"receiver","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"isRedeemed","type":"bool"},{"internalType":"bytes32","name":"messageId","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"feeBps","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"feeReceiver","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"_messageId","type":"bytes32"}],"name":"getFailedMessageByMessageId","outputs":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"receiver","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"isRedeemed","type":"bool"},{"internalType":"bytes32","name":"messageId","type":"bytes32"}],"internalType":"struct CCIP.FailedMessagesUsers","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"offset","type":"uint256"},{"internalType":"uint256","name":"limit","type":"uint256"}],"name":"getFailedMessages","outputs":[{"components":[{"internalType":"bytes32","name":"messageId","type":"bytes32"},{"internalType":"enum CCIP.ErrorCode","name":"errorCode","type":"uint8"}],"internalType":"struct CCIP.FailedMessage[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"},{"internalType":"uint256","name":"_offset","type":"uint256"},{"internalType":"uint256","name":"_limit","type":"uint256"}],"name":"getFailedMessagesUser","outputs":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"receiver","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bool","name":"isRedeemed","type":"bool"},{"internalType":"bytes32","name":"messageId","type":"bytes32"}],"internalType":"struct CCIP.FailedMessagesUsers[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes","name":"_path","type":"bytes"}],"name":"getLastAddressPath","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"getLastReceivedMessageDetails","outputs":[{"internalType":"bytes32","name":"messageId","type":"bytes32"},{"internalType":"string","name":"text","type":"string"},{"internalType":"address","name":"tokenAddress","type":"address"},{"internalType":"uint256","name":"tokenAmount","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getLengthFailedMessagesUser","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getRouter","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"bytes32","name":"messageId","type":"bytes32"},{"internalType":"uint64","name":"sourceChainSelector","type":"uint64"},{"internalType":"bytes","name":"sender","type":"bytes"},{"internalType":"bytes","name":"data","type":"bytes"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct Client.EVMTokenAmount[]","name":"destTokenAmounts","type":"tuple[]"}],"internalType":"struct Client.Any2EVMMessage","name":"any2EvmMessage","type":"tuple"}],"name":"processMessage","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"tokenReceiver","type":"address"},{"internalType":"uint256","name":"index","type":"uint256"}],"name":"recoverFailedTransfer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"messageId","type":"bytes32"},{"internalType":"address","name":"tokenReceiver","type":"address"},{"internalType":"uint256","name":"index","type":"uint256"}],"name":"retryFailedMessage","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"messageId","type":"bytes32"}],"name":"s_messageContents","outputs":[{"internalType":"bytes32","name":"messageId","type":"bytes32"},{"internalType":"uint64","name":"sourceChainSelector","type":"uint64"},{"internalType":"bytes","name":"sender","type":"bytes"},{"internalType":"bytes","name":"data","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint64","name":"_destinationChainSelector","type":"uint64"},{"internalType":"address","name":"_receiverCCIPInOtherChain","type":"address"},{"internalType":"uint256","name":"_gasLimitReceiver","type":"uint256"},{"internalType":"bool","name":"_isLinkOrNative","type":"bool"},{"components":[{"internalType":"address","name":"tokenIn","type":"address"},{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"minAmountOutV2Swap","type":"uint256"},{"internalType":"uint256","name":"minAmountOutV3Swap","type":"uint256"},{"internalType":"bool","name":"swapTokenInV2First","type":"bool"},{"internalType":"bool","name":"unwrappedETH","type":"bool"},{"internalType":"bytes","name":"v3InitialSwap","type":"bytes"}],"internalType":"struct CCIP.InitialSwapData","name":"_initialSwapData","type":"tuple"},{"components":[{"internalType":"address","name":"finalToken","type":"address"},{"internalType":"address","name":"userReceiver","type":"address"},{"internalType":"uint256","name":"minAmountOut","type":"uint256"},{"internalType":"uint256","name":"minAmountOutV2Swap","type":"uint256"},{"internalType":"bool","name":"isV2","type":"bool"},{"internalType":"bool","name":"unwrapETH","type":"bool"},{"internalType":"bytes","name":"path","type":"bytes"},{"internalType":"address[]","name":"v2Path","type":"address[]"}],"internalType":"struct CCIP.ReceiverSwapData","name":"_receiverSwapData","type":"tuple"}],"name":"sendMessagePayFirstStep","outputs":[{"internalType":"bytes32","name":"messageId","type":"bytes32"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"swapFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"timeLockTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"usdc","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"v2Router","outputs":[{"internalType":"contract IUniswapV2Router02","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"v3Router","outputs":[{"internalType":"contract IV3SwapRouter","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"weth","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_beneficiary","type":"address"}],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_beneficiary","type":"address"},{"internalType":"address","name":"_token","type":"address"}],"name":"withdrawToken","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]
const bytecode = '6101006040523480156200001257600080fd5b506040516200555a3803806200555a8339810160408190526200003591620001e3565b33876001600160a01b03811662000067576040516335fdcccd60e21b8152600060048201526024015b60405180910390fd5b6001600160a01b0390811660805281166200009957604051631e4fbdf760e01b8152600060048201526024016200005e565b620000a48162000176565b506001600160a01b0386811660a052600e80546001600160a01b0319908116878416908117909255600f805490911686841617905590861660e052604080516312a9293f60e21b81529051634aa4a4fc916004808201926020929091908290030181865afa1580156200011b573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200014191906200026f565b6001600160a01b0390811660c052601092909255601180546001600160a01b0319169190921617905550620002949350505050565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b80516001600160a01b0381168114620001de57600080fd5b919050565b600080600080600080600060e0888a031215620001ff57600080fd5b6200020a88620001c6565b96506200021a60208901620001c6565b95506200022a60408901620001c6565b94506200023a60608901620001c6565b93506200024a60808901620001c6565b925060a088015191506200026160c08901620001c6565b905092959891949750929550565b6000602082840312156200028257600080fd5b6200028d82620001c6565b9392505050565b60805160a05160c05160e0516151cf6200038b600039600081816103ab01528181610b9301528181610c4001528181610c96015281816117f701528181611f74015281816123120152818161244a0152818161253a0152818161315f015281816131b0015261320701526000818161043e01528181610999015281816109d801528181611fd0015281816120b9015281816121190152818161220f015281816122a40152818161337501528181613493015261351f015260008181611bd1015281816125e6015281816126fc0152818161278b01528181612848015261296601526000818161073801526115eb01526151cf6000f3fe60806040526004361061023f5760003560e01c806363a5d2981161012e578063a05bdb5b116100ab578063d0d1fc3d1161006f578063d0d1fc3d146107bc578063db04fa49146107ec578063deadbc141461080c578063eab5b02c1461082c578063f2fde38b1461084c57600080fd5b8063a05bdb5b14610709578063b0f479a114610729578063b3f006741461075c578063b4498fd51461077c578063cf6730f81461079c57600080fd5b806385572ffb116100f257806385572ffb1461065e5780638d9d89fe1461067e5780638da5cb5b146106ab57806396d3b83d146106c957806398895095146106e957600080fd5b806363a5d298146105b8578063715018a6146105cd57806375c67c66146105e257806380665c2a1461061257806382b55c7b1461062857600080fd5b80633e957731116101bc57806351cff8d91161018057806351cff8d91461050557806354cf2aeb146105255780635aacd56a1461053b5780636122750f146105685780636159ada11461058857600080fd5b80633e957731146103cd5780633fc8cef31461042c5780634030d521146104605780634b127efd146104905780634dd31560146104e557600080fd5b806324a9d8531161020357806324a9d85314610311578063263596a5146103275780632c94785a1461034c5780633aeac4e1146103795780633e413bee1461039957600080fd5b806301f59d161461024b57806301ffc9a7146102745780630dc91306146102a45780631fce30e3146102dc57806320446c0b146102ef57600080fd5b3661024657005b600080fd5b34801561025757600080fd5b50610261614e2081565b6040519081526020015b60405180910390f35b34801561028057600080fd5b5061029461028f366004613b5b565b61086c565b604051901515815260200161026b565b3480156102b057600080fd5b50600e546102c4906001600160a01b031681565b6040516001600160a01b03909116815260200161026b565b6102616102ea366004613e96565b6108a3565b3480156102fb57600080fd5b5061030f61030a366004613fb8565b610cc8565b005b34801561031d57600080fd5b506102616103e881565b34801561033357600080fd5b5061033c610d35565b60405161026b9493929190614041565b34801561035857600080fd5b5061036c610367366004614076565b610df4565b60405161026b91906140cc565b34801561038557600080fd5b5061030f610394366004613fb8565b610eb9565b3480156103a557600080fd5b506102c47f000000000000000000000000000000000000000000000000000000000000000081565b3480156103d957600080fd5b5061040d6103e8366004614076565b600a60205260009081526040902080546001909101546001600160a01b039091169082565b604080516001600160a01b03909316835260208301919091520161026b565b34801561043857600080fd5b506102c47f000000000000000000000000000000000000000000000000000000000000000081565b34801561046c57600080fd5b5061029461047b3660046140da565b60066020526000908152604090205460ff1681565b34801561049c57600080fd5b506104b06104ab3660046140f7565b610f9b565b604080516001600160a01b0396871681529590941660208601529284019190915215156060830152608082015260a00161026b565b3480156104f157600080fd5b5061030f6105003660046140f7565b610ff9565b34801561051157600080fd5b5061030f610520366004614123565b611189565b34801561053157600080fd5b5061026160105481565b34801561054757600080fd5b5061055b610556366004614140565b611275565b60405161026b9190614175565b34801561057457600080fd5b5061030f6105833660046141c3565b6113c3565b34801561059457600080fd5b506102946105a3366004614123565b60076020526000908152604090205460ff1681565b3480156105c457600080fd5b5061030f611587565b3480156105d957600080fd5b5061030f6115cc565b3480156105ee57600080fd5b506102946105fd3660046140da565b60056020526000908152604090205460ff1681565b34801561061e57600080fd5b5061026160125481565b34801561063457600080fd5b50610261610643366004614123565b6001600160a01b031660009081526009602052604090205490565b34801561066a57600080fd5b5061030f6106793660046141fb565b6115e0565b34801561068a57600080fd5b5061069e610699366004614235565b611976565b60405161026b919061426d565b3480156106b757600080fd5b506000546001600160a01b03166102c4565b3480156106d557600080fd5b5061030f6106e43660046142da565b611aa6565b3480156106f557600080fd5b5061030f610704366004614308565b611ad9565b34801561071557600080fd5b506102c461072436600461432d565b611b80565b34801561073557600080fd5b507f00000000000000000000000000000000000000000000000000000000000000006102c4565b34801561076857600080fd5b506011546102c4906001600160a01b031681565b34801561078857600080fd5b50610261610797366004614361565b611b9a565b3480156107a857600080fd5b5061030f6107b73660046141fb565b611cdd565b3480156107c857600080fd5b506107dc6107d7366004614076565b611d11565b60405161026b94939291906143fb565b3480156107f857600080fd5b5061030f6108073660046142da565b611e54565b34801561081857600080fd5b50600f546102c4906001600160a01b031681565b34801561083857600080fd5b5061030f610847366004614435565b611e87565b34801561085857600080fd5b5061030f610867366004614123565b611eba565b60006001600160e01b031982166385572ffb60e01b148061089d57506001600160e01b031982166301ffc9a760e01b145b92915050565b6001600160401b038616600090815260056020526040812054879060ff166108ee57604051630a503cdb60e01b81526001600160401b03821660048201526024015b60405180910390fd5b866001600160a01b0381166109165760405163502ffa3f60e11b815260040160405180910390fd5b6001600160a01b03881660009081526007602052604090205460ff1661098a5760405162461bcd60e51b815260206004820152602360248201527f4d75737420626520612076616c69642064657374696e6174696f6e206164647260448201526265737360e81b60648201526084016108e5565b8460a001511580156109d157507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031685600001516001600160a01b0316145b15610a73577f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663d0e30db0866020015134610a159190614469565b6040518263ffffffff1660e01b81526004016000604051808303818588803b158015610a4057600080fd5b505af1158015610a54573d6000803e3d6000fd5b5050505050846020015134610a699190614469565b6020860152610b80565b84516040516370a0823160e01b81523060048201526000916001600160a01b0316906370a0823190602401602060405180830381865afa158015610abb573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610adf919061447c565b60208701518751919250610b00916001600160a01b03169033903090611eff565b85516040516370a0823160e01b81523060048201526000916001600160a01b0316906370a0823190602401602060405180830381865afa158015610b48573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b6c919061447c565b9050610b788282614469565b602088015250505b6000610b8f8660c00151611b80565b90507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316816001600160a01b031614610c065760405162461bcd60e51b81526020600482015260116024820152704d757374207377617020746f205553444360781b60448201526064016108e5565b6000610c1187611f70565b90508715610c6f57610c668b8b88604051602001610c2f91906144d9565b6040516020818303038152906040527f0000000000000000000000000000000000000000000000000000000000000000858e61256d565b94505050610cbc565b610c668b8b88604051602001610c8591906144d9565b6040516020818303038152906040527f0000000000000000000000000000000000000000000000000000000000000000858e6129af565b50509695505050505050565b610cd0612c25565b6000601254118015610ce3575060125442115b610cff5760405162461bcd60e51b81526004016108e590614581565b6000601255600e80546001600160a01b039283166001600160a01b031991821617909155600f8054939092169216919091179055565b600060606000806001546004600260009054906101000a90046001600160a01b0316600354828054610d66906145a5565b80601f0160208091040260200160405190810160405280929190818152602001828054610d92906145a5565b8015610ddf5780601f10610db457610100808354040283529160200191610ddf565b820191906000526020600020905b815481529060010190602001808311610dc257829003601f168201915b50505050509250935093509350935090919293565b6040805160a081018252600080825260208083018290528284018290526060830182905260808301829052848252600a815283822080546001600160a01b031683526009909152929020600183015481549293928110610e5657610e566145df565b60009182526020918290206040805160a081018252600590930290910180546001600160a01b03908116845260018201541693830193909352600283015490820152600382015460ff161515606082015260049091015460808201529392505050565b610ec1612c25565b6000601254118015610ed4575060125442115b610ef05760405162461bcd60e51b81526004016108e590614581565b426012556040516370a0823160e01b81523060048201526000906001600160a01b038316906370a0823190602401602060405180830381865afa158015610f3b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610f5f919061447c565b905080600003610f8257604051630686827b60e51b815260040160405180910390fd5b610f966001600160a01b0383168483612c52565b505050565b60096020528160005260406000208181548110610fb757600080fd5b6000918252602090912060059091020180546001820154600283015460038401546004909401546001600160a01b0393841696509290911693509160ff169085565b6001600160a01b0382166000908152600960205260408120805483908110611023576110236145df565b60009182526020909120600590910201600381015490915060ff161561107e5760405162461bcd60e51b815260206004820152601060248201526f105b1c9958591e481c995919595b595960821b60448201526064016108e5565b600381018054600160ff1990911681179091558101546001600160a01b031633146110eb5760405162461bcd60e51b815260206004820181905260248201527f4d7573742062652065786563757465642062792074686520726563656976657260448201526064016108e5565b600160048201546110fe90600b90612c82565b14611122576004818101546040516305b73c1360e51b8152918201526024016108e5565b60048101546111379060005b600b9190612c8e565b5060028101548154611156916001600160a01b03909116908590612c52565b60048101546040517fef3bf8c64bc480286c4f3503b870ceb23e648d2d902e31fb7bb46680da6de8ad90600090a2505050565b611191612c25565b60006012541180156111a4575060125442115b6111c05760405162461bcd60e51b81526004016108e590614581565b6000601281905547908190036111e957604051630686827b60e51b815260040160405180910390fd5b6000826001600160a01b03168260405160006040518083038185875af1925050503d8060008114611236576040519150601f19603f3d011682016040523d82523d6000602084013e61123b565b606091505b5050905080610f9657604051639d11f56360e01b81523360048201526001600160a01b0384166024820152604481018390526064016108e5565b60606000826001600160401b0381111561129157611291613be3565b6040519080825280602002602001820160405280156112ea57816020015b6040805160a0810182526000808252602080830182905292820181905260608201819052608082015282526000199092019101816112af5790505b50905060005b838110156113b8576001600160a01b038616600090815260096020526040902061131a82876145f5565b8154811061132a5761132a6145df565b60009182526020918290206040805160a081018252600590930290910180546001600160a01b03908116845260018201541693830193909352600283015490820152600382015460ff16151560608201526004909101546080820152825183908390811061139a5761139a6145df565b602002602001018190525080806113b090614608565b9150506112f0565b5090505b9392505050565b6113cb612c25565b60016113d8600b85612c82565b146113f9576040516305b73c1360e51b8152600481018490526024016108e5565b61140483600061112e565b506001600160a01b038216600090815260096020526040902080548290811061142f5761142f6145df565b600091825260209091206003600590920201015460ff16156114865760405162461bcd60e51b815260206004820152601060248201526f105b1c9958591e481c995919595b595960821b60448201526064016108e5565b6001600160a01b0382166000908152600960205260409020805460019190839081106114b4576114b46145df565b906000526020600020906005020160030160006101000a81548160ff0219169083151502179055506000600860008581526020019081526020016000209050611556838260040160008154811061150d5761150d6145df565b90600052602060002090600202016001015483600401600081548110611535576115356145df565b60009182526020909120600290910201546001600160a01b03169190612c52565b60405184907fef3bf8c64bc480286c4f3503b870ceb23e648d2d902e31fb7bb46680da6de8ad90600090a250505050565b61158f612c25565b61159c426202a3006145f5565b60128190556040517f7c907b8735e3b64d39d41766c0e80d8acd40b0a9fd407745b5d0b396488a4b4890600090a2565b6115d4612c25565b6115de6000612ca3565b565b336001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000161461162b576040516335fdcccd60e21b81523360048201526024016108e5565b61163b60408201602083016140da565b6116486040830183614621565b8101906116559190614123565b6001600160401b03821660009081526006602052604090205460ff166116995760405163042784cf60e31b81526001600160401b03831660048201526024016108e5565b6001600160a01b03811660009081526007602052604090205460ff166116dd576040516368692cbb60e11b81526001600160a01b03821660048201526024016108e5565b6040516319ece61f60e31b8152309063cf6730f89061170090869060040161471d565b600060405180830381600087803b15801561171a57600080fd5b505af192505050801561172b575060015b610f96573d808015611759576040519150601f19603f3d011682016040523d82523d6000602084013e61175e565b606091505b5061176b8435600161112e565b508335600090815260086020526040902084906117888282614a46565b506000905061179a6060860186614621565b8101906117a79190614b09565b90506000818060200190518101906117bf9190614c1b565b90506009600082602001516001600160a01b03166001600160a01b031681526020019081526020016000206040518060a001604052807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316815260200183602001516001600160a01b0316815260200188806080019061184791906148f4565b6000818110611858576118586145df565b604090810292909201602090810135845260008482018190528c35948401859052865460018082018955978252828220875160059092020180546001600160a01b03199081166001600160a01b0393841617825588850151828b0180548316918516919091179055888701516002830155606089015160038301805460ff19169115159190911790556080909801516004909101558451808601865289840180518316825251821683526009845285832054818501908152878452600a9094529185902091518254909716961695909517855551939094019290925590519091507f55bc02a9ef6f146737edeeb425738006f67f077e7138de3bf84a15bde1a5b56f90611966908690614d04565b60405180910390a2505050505050565b60606000611984600b612cf3565b905060008161199385876145f5565b1161199e57836119a8565b6119a88583614469565b90506000816001600160401b038111156119c4576119c4613be3565b604051908082528060200260200182016040528015611a0957816020015b60408051808201909152600080825260208201528152602001906001900390816119e25790505b50905060005b82811015611a9c57600080611a2f611a27848b6145f5565b600b90612cfe565b915091506040518060400160405280838152602001826001811115611a5657611a56614257565b6001811115611a6757611a67614257565b815250848481518110611a7c57611a7c6145df565b602002602001018190525050508080611a9490614608565b915050611a0f565b5095945050505050565b611aae612c25565b6001600160401b03919091166000908152600560205260409020805460ff1916911515919091179055565b611ae1612c25565b6000601254118015611af4575060125442115b611b105760405162461bcd60e51b81526004016108e590614581565b6000601255614e208210611b595760405162461bcd60e51b815260206004820152601060248201526f13585e0819995948195e18d95959195960821b60448201526064016108e5565b601091909155601180546001600160a01b0319166001600160a01b03909216919091179055565b600061089d60148351611b939190614469565b8390612d1c565b600080611bf78884604051602001611bb291906144d9565b604051602081830303815290604052898988611bcf576000611bf1565b7f00000000000000000000000000000000000000000000000000000000000000005b8a612dd0565b90506000306001600160a01b031663b0f479a16040518163ffffffff1660e01b8152600401602060405180830381865afa158015611c39573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611c5d9190614d17565b6040516320487ded60e01b81529091506001600160a01b038216906320487ded90611c8e908d908690600401614d34565b602060405180830381865afa158015611cab573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611ccf919061447c565b9a9950505050505050505050565b333014611cfd5760405163029a949d60e31b815260040160405180910390fd5b611d0e611d0982614e87565b612f5b565b50565b60086020526000908152604090208054600182015460028301805492936001600160401b0390921692611d43906145a5565b80601f0160208091040260200160405190810160405280929190818152602001828054611d6f906145a5565b8015611dbc5780601f10611d9157610100808354040283529160200191611dbc565b820191906000526020600020905b815481529060010190602001808311611d9f57829003601f168201915b505050505090806003018054611dd1906145a5565b80601f0160208091040260200160405190810160405280929190818152602001828054611dfd906145a5565b8015611e4a5780601f10611e1f57610100808354040283529160200191611e4a565b820191906000526020600020905b815481529060010190602001808311611e2d57829003601f168201915b5050505050905084565b611e5c612c25565b6001600160401b03919091166000908152600660205260409020805460ff1916911515919091179055565b611e8f612c25565b6001600160a01b03919091166000908152600760205260409020805460ff1916911515919091179055565b611ec2612c25565b6000601254118015611ed5575060125442115b611ef15760405162461bcd60e51b81526004016108e590614581565b6000601255611d0e81611eba565b6040516001600160a01b0380851660248301528316604482015260648101829052611f6a9085906323b872dd60e01b906084015b60408051601f198184030181529190526020810180516001600160e01b03166001600160e01b0319909316929092179091526135c6565b50505050565b60007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031682600001516001600160a01b031603611fba57506020810151612500565b8160800151156122dc5781516001600160a01b037f000000000000000000000000000000000000000000000000000000000000000081169116036120405760405162461bcd60e51b815260206004820152601960248201527f546f6b656e20696e206d757374206e6f7420626520574554480000000000000060448201526064016108e5565b8151600f54602084015161205e92916001600160a01b031690613698565b604080516002808252606082018352600092602083019080368337019050509050826000015181600081518110612097576120976145df565b60200260200101906001600160a01b031690816001600160a01b0316815250507f0000000000000000000000000000000000000000000000000000000000000000816001815181106120eb576120eb6145df565b6001600160a01b0392831660209182029290920101526040516370a0823160e01b81523060048201526000917f000000000000000000000000000000000000000000000000000000000000000016906370a0823190602401602060405180830381865afa158015612160573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612184919061447c565b600f5460208601516040808801519051635c11d79560e01b81529394506001600160a01b0390921692635c11d795926121c69291879030904290600401614f33565b600060405180830381600087803b1580156121e057600080fd5b505af11580156121f4573d6000803e3d6000fd5b50506040516370a0823160e01b8152306004820152600092507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031691506370a0823190602401602060405180830381865afa15801561225f573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612283919061447c565b905060006122918383614469565b60208701819052600e549091506122d3907f0000000000000000000000000000000000000000000000000000000000000000906001600160a01b031683613698565b505050506122fa565b8151600e5460208401516122fa92916001600160a01b031690613698565b6040516370a0823160e01b81523060048201526000907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa158015612361573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612385919061447c565b6040805160808101825260c08601518152306020808301919091528601518183015260608087015190820152600e54915163b858183f60e01b8152929350916001600160a01b039091169063b858183f906123e4908490600401614f6f565b6020604051808303816000875af1158015612403573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612427919061447c565b6040516370a0823160e01b81523060048201529093506000906001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906370a0823190602401602060405180830381865afa158015612491573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906124b5919061447c565b90508281116124fc5760405162461bcd60e51b81526020600482015260136024820152724d757374207377617020696e746f205553444360681b60448201526064016108e5565b5050505b600061250f6103e8606461493d565b60105461251c908461493d565b6125269190614fbd565b601154909150612563906001600160a01b037f00000000000000000000000000000000000000000000000000000000000000008116911683612c52565b6113bc8183614469565b6001600160401b038616600090815260056020526040812054879060ff166125b357604051630a503cdb60e01b81526001600160401b03821660048201526024016108e5565b866001600160a01b0381166125db5760405163502ffa3f60e11b815260040160405180910390fd5b600061260b898989897f00000000000000000000000000000000000000000000000000000000000000008a612dd0565b90506000306001600160a01b031663b0f479a16040518163ffffffff1660e01b8152600401602060405180830381865afa15801561264d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906126719190614d17565b90506000816001600160a01b03166320487ded8d856040518363ffffffff1660e01b81526004016126a3929190614d34565b602060405180830381865afa1580156126c0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906126e4919061447c565b6040516370a0823160e01b81523060048201529091507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa15801561274b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061276f919061447c565b811115612822576040516370a0823160e01b81523060048201527f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa1580156127da573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906127fe919061447c565b604051634787a10360e11b81526004810191909152602481018290526044016108e5565b60405163095ea7b360e01b81526001600160a01b038381166004830152602482018390527f0000000000000000000000000000000000000000000000000000000000000000169063095ea7b3906044016020604051808303816000875af1158015612891573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906128b59190614fdf565b506128c189838a613698565b6040516396f4e9f960e01b81526001600160a01b038316906396f4e9f9906128ef908f908790600401614d34565b6020604051808303816000875af115801561290e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612932919061447c565b95508b6001600160401b0316867f437cb3c5ba4364504dda6ba3c906ffb0897c7beeb1675f3aaf22a1b9a99b39948d8d8d8d7f00000000000000000000000000000000000000000000000000000000000000008860405161299896959493929190614ffc565b60405180910390a350505050509695505050505050565b6001600160401b038616600090815260056020526040812054879060ff166129f557604051630a503cdb60e01b81526001600160401b03821660048201526024016108e5565b866001600160a01b038116612a1d5760405163502ffa3f60e11b815260040160405180910390fd5b6000612a2e8989898960008a612dd0565b90506000306001600160a01b031663b0f479a16040518163ffffffff1660e01b8152600401602060405180830381865afa158015612a70573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612a949190614d17565b90506000816001600160a01b03166320487ded8d856040518363ffffffff1660e01b8152600401612ac6929190614d34565b602060405180830381865afa158015612ae3573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612b07919061447c565b905047811115612b3357604051634787a10360e11b8152476004820152602481018290526044016108e5565b612b3e89838a613698565b816001600160a01b03166396f4e9f9828e866040518463ffffffff1660e01b8152600401612b6d929190614d34565b60206040518083038185885af1158015612b8b573d6000803e3d6000fd5b50505050506040513d601f19601f82011682018060405250810190612bb0919061447c565b60405190965033904780156108fc02916000818181858888f19350505050158015612bdf573d6000803e3d6000fd5b508b6001600160401b0316867f437cb3c5ba4364504dda6ba3c906ffb0897c7beeb1675f3aaf22a1b9a99b39948d8d8d8d60008860405161299896959493929190614ffc565b6000546001600160a01b031633146115de5760405163118cdaa760e01b81523360048201526024016108e5565b6040516001600160a01b038316602482015260448101829052610f9690849063a9059cbb60e01b90606401611f33565b60006113bc838361373c565b6000612c9b8484846137ac565b949350505050565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b600061089d826137c9565b6000808080612d0d86866137d4565b909450925050505b9250929050565b600081612d2a8160146145f5565b1015612d6d5760405162461bcd60e51b8152602060048201526012602482015271746f416464726573735f6f766572666c6f7760701b60448201526064016108e5565b612d788260146145f5565b83511015612dc05760405162461bcd60e51b8152602060048201526015602482015274746f416464726573735f6f75744f66426f756e647360581b60448201526064016108e5565b500160200151600160601b900490565b612e0b6040518060a0016040528060608152602001606081526020016060815260200160006001600160a01b03168152602001606081525090565b604080516001808252818301909252600091816020015b6040805180820190915260008082526020820152815260200190600190039081612e2257905050905060006040518060400160405280886001600160a01b031681526020018781525090508082600081518110612e8157612e816145df565b60209081029190910101526040805160a081019091526001600160a01b038a1660c08201526000908060e0810160405160208183030381529060405281526020018a604051602001612ed39190614d04565b6040516020818303038152906040528152602001848152602001876001600160a01b03168152602001612f4b60405180602001604052808981525060408051915160248084019190915281518084039091018152604490920190526020810180516001600160e01b03166397a657c960e01b17905290565b90529a9950505050505050505050565b805160015560608101518051612f7991602091810182019101615042565b600490612f86908261508a565b508060800151600081518110612f9e57612f9e6145df565b602002602001015160000151600260006101000a8154816001600160a01b0302191690836001600160a01b031602179055508060800151600081518110612fe757612fe76145df565b60200260200101516020015160038190555080602001516001600160401b031681600001517f90ec910a8f80bb04e184a806e2ae6f8786ef2ae898859a3180f953397edc120183604001518060200190518101906130459190614d17565b846060015180602001905181019061305d9190615042565b8560800151600081518110613074576130746145df565b6020026020010151600001518660800151600081518110613097576130976145df565b6020026020010151602001516040516130b39493929190615149565b60405180910390a36000600480546130ca906145a5565b80601f01602080910402602001604051908101604052809291908181526020018280546130f6906145a5565b80156131435780601f1061311857610100808354040283529160200191613143565b820191906000526020600020905b81548152906001019060200180831161312657829003601f168201915b505050505080602001905181019061315b9190614c1b565b90507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031681600001516001600160a01b0316036131da5760208101516003546131d6916001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001691612c52565b5050565b600e5460035460405163095ea7b360e01b81526001600160a01b03928316600482015260248101919091527f00000000000000000000000000000000000000000000000000000000000000009091169063095ea7b3906044016020604051808303816000875af1158015613252573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906132769190614fdf565b50600060405180608001604052808360c00151815260200183608001518061329f57508360a001515b6132ad5783602001516132af565b305b6001600160a01b039081168252600354602083015260408581015192810192909252600e54915163b858183f60e01b815292935060009291169063b858183f906132fd908590600401614f6f565b6020604051808303816000875af115801561331c573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190613340919061447c565b905082608001511561347157600f5460405163095ea7b360e01b81526001600160a01b039182166004820152602481018390527f00000000000000000000000000000000000000000000000000000000000000009091169063095ea7b3906044016020604051808303816000875af11580156133c0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906133e49190614fdf565b50600f54606084015160e085015160a08601516001600160a01b0390931692635c11d795928592909161341b57876020015161341d565b305b426040518663ffffffff1660e01b815260040161343e959493929190614f33565b600060405180830381600087803b15801561345857600080fd5b505af115801561346c573d6000803e3d6000fd5b505050505b8260a0015115611f6a576040516370a0823160e01b81523060048201526000907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa1580156134e2573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190613506919061447c565b604051632e1a7d4d60e01b8152600481018290529091507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031690632e1a7d4d90602401600060405180830381600087803b15801561356b57600080fd5b505af115801561357f573d6000803e3d6000fd5b50505060208501516040516001600160a01b0390911691504780156108fc02916000818181858888f193505050501580156135be573d6000803e3d6000fd5b505050505050565b600061361b826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564815250856001600160a01b03166137ff9092919063ffffffff16565b805190915015610f9657808060200190518101906136399190614fdf565b610f965760405162461bcd60e51b815260206004820152602a60248201527f5361666545524332303a204552433230206f7065726174696f6e20646964206e6044820152691bdd081cdd58d8d9595960b21b60648201526084016108e5565b604051636eb1769f60e11b81523060048201526001600160a01b03838116602483015282919085169063dd62ed3e90604401602060405180830381865afa1580156136e7573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061370b919061447c565b1015610f96576137266001600160a01b03841683600061380e565b610f966001600160a01b0384168360001961380e565b60008181526002830160205260408120548015158061376057506137608484613923565b6113bc5760405162461bcd60e51b815260206004820152601e60248201527f456e756d657261626c654d61703a206e6f6e6578697374656e74206b6579000060448201526064016108e5565b60008281526002840160205260408120829055612c9b848461392f565b600061089d8261393b565b600080806137e28585613945565b600081815260029690960160205260409095205494959350505050565b6060612c9b8484600085613951565b8015806138885750604051636eb1769f60e11b81523060048201526001600160a01b03838116602483015284169063dd62ed3e90604401602060405180830381865afa158015613862573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190613886919061447c565b155b6138f35760405162461bcd60e51b815260206004820152603660248201527f5361666545524332303a20617070726f76652066726f6d206e6f6e2d7a65726f60448201527520746f206e6f6e2d7a65726f20616c6c6f77616e636560501b60648201526084016108e5565b6040516001600160a01b038316602482015260448101829052610f9690849063095ea7b360e01b90606401611f33565b60006113bc8383613a2c565b60006113bc8383613a44565b600061089d825490565b60006113bc8383613a93565b6060824710156139b25760405162461bcd60e51b815260206004820152602660248201527f416464726573733a20696e73756666696369656e742062616c616e636520666f6044820152651c8818d85b1b60d21b60648201526084016108e5565b600080866001600160a01b031685876040516139ce919061517d565b60006040518083038185875af1925050503d8060008114613a0b576040519150601f19603f3d011682016040523d82523d6000602084013e613a10565b606091505b5091509150613a2187838387613abd565b979650505050505050565b600081815260018301602052604081205415156113bc565b6000818152600183016020526040812054613a8b5750815460018181018455600084815260208082209093018490558454848252828601909352604090209190915561089d565b50600061089d565b6000826000018281548110613aaa57613aaa6145df565b9060005260206000200154905092915050565b60608315613b2c578251600003613b25576001600160a01b0385163b613b255760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e747261637400000060448201526064016108e5565b5081612c9b565b612c9b8383815115613b415781518083602001fd5b8060405162461bcd60e51b81526004016108e59190614d04565b600060208284031215613b6d57600080fd5b81356001600160e01b0319811681146113bc57600080fd5b6001600160401b0381168114611d0e57600080fd5b8035613ba581613b85565b919050565b6001600160a01b0381168114611d0e57600080fd5b8035613ba581613baa565b8015158114611d0e57600080fd5b8035613ba581613bca565b634e487b7160e01b600052604160045260246000fd5b60405161010081016001600160401b0381118282101715613c1c57613c1c613be3565b60405290565b60405160e081016001600160401b0381118282101715613c1c57613c1c613be3565b604080519081016001600160401b0381118282101715613c1c57613c1c613be3565b60405160a081016001600160401b0381118282101715613c1c57613c1c613be3565b604051601f8201601f191681016001600160401b0381118282101715613cb057613cb0613be3565b604052919050565b60006001600160401b03821115613cd157613cd1613be3565b50601f01601f191660200190565b6000613cf2613ced84613cb8565b613c88565b9050828152838383011115613d0657600080fd5b828260208301376000602084830101529392505050565b600082601f830112613d2e57600080fd5b6113bc83833560208501613cdf565b60006001600160401b03821115613d5657613d56613be3565b5060051b60200190565b600082601f830112613d7157600080fd5b81356020613d81613ced83613d3d565b82815260059290921b84018101918181019086841115613da057600080fd5b8286015b84811015613dc4578035613db781613baa565b8352918301918301613da4565b509695505050505050565b60006101008284031215613de257600080fd5b613dea613bf9565b9050613df582613bbf565b8152613e0360208301613bbf565b60208201526040820135604082015260608201356060820152613e2860808301613bd8565b6080820152613e3960a08301613bd8565b60a082015260c08201356001600160401b0380821115613e5857600080fd5b613e6485838601613d1d565b60c084015260e0840135915080821115613e7d57600080fd5b50613e8a84828501613d60565b60e08301525092915050565b60008060008060008060c08789031215613eaf57600080fd5b8635613eba81613b85565b95506020870135613eca81613baa565b9450604087013593506060870135613ee181613bca565b925060808701356001600160401b0380821115613efd57600080fd5b9088019060e0828b031215613f1157600080fd5b613f19613c22565b613f2283613bbf565b8152602083013560208201526040830135604082015260608301356060820152613f4e60808401613bd8565b6080820152613f5f60a08401613bd8565b60a082015260c083013582811115613f7657600080fd5b613f828c828601613d1d565b60c083015250935060a0890135915080821115613f9e57600080fd5b50613fab89828a01613dcf565b9150509295509295509295565b60008060408385031215613fcb57600080fd5b8235613fd681613baa565b91506020830135613fe681613baa565b809150509250929050565b60005b8381101561400c578181015183820152602001613ff4565b50506000910152565b6000815180845261402d816020860160208601613ff1565b601f01601f19169290920160200192915050565b84815260806020820152600061405a6080830186614015565b6001600160a01b03949094166040830152506060015292915050565b60006020828403121561408857600080fd5b5035919050565b80516001600160a01b0390811683526020808301519091169083015260408082015190830152606080820151151590830152608090810151910152565b60a0810161089d828461408f565b6000602082840312156140ec57600080fd5b81356113bc81613b85565b6000806040838503121561410a57600080fd5b823561411581613baa565b946020939093013593505050565b60006020828403121561413557600080fd5b81356113bc81613baa565b60008060006060848603121561415557600080fd5b833561416081613baa565b95602085013595506040909401359392505050565b6020808252825182820181905260009190848201906040850190845b818110156141b7576141a483855161408f565b9284019260a09290920191600101614191565b50909695505050505050565b6000806000606084860312156141d857600080fd5b8335925060208401356141ea81613baa565b929592945050506040919091013590565b60006020828403121561420d57600080fd5b81356001600160401b0381111561422357600080fd5b820160a081850312156113bc57600080fd5b6000806040838503121561424857600080fd5b50508035926020909101359150565b634e487b7160e01b600052602160045260246000fd5b60208082528251828201819052600091906040908185019086840185805b838110156142cc57825180518652870151600281106142b857634e487b7160e01b83526021600452602483fd5b85880152938501939186019160010161428b565b509298975050505050505050565b600080604083850312156142ed57600080fd5b82356142f881613b85565b91506020830135613fe681613bca565b6000806040838503121561431b57600080fd5b823591506020830135613fe681613baa565b60006020828403121561433f57600080fd5b81356001600160401b0381111561435557600080fd5b612c9b84828501613d1d565b600080600080600080600060e0888a03121561437c57600080fd5b873561438781613b85565b9650602088013561439781613baa565b955060408801356143a781613baa565b9450606088013593506080880135925060a08801356143c581613bca565b915060c08801356001600160401b038111156143e057600080fd5b6143ec8a828b01613dcf565b91505092959891949750929550565b8481526001600160401b03841660208201526080604082015260006144236080830185614015565b8281036060840152613a218185614015565b6000806040838503121561444857600080fd5b82356142f881613baa565b634e487b7160e01b600052601160045260246000fd5b8181038181111561089d5761089d614453565b60006020828403121561448e57600080fd5b5051919050565b600081518084526020808501945080840160005b838110156144ce5781516001600160a01b0316875295820195908201906001016144a9565b509495945050505050565b602080825282516001600160a01b03168282015282015160009061450860408401826001600160a01b03169052565b506040830151606083015260608301516080830152608083015161453060a084018215159052565b5060a083015180151560c08401525060c08301516101008060e085015261455b610120850183614015565b915060e0850151601f1985840301828601526145778382614495565b9695505050505050565b6020808252600a9082015269151a5b595b1bd8dad95960b21b604082015260600190565b600181811c908216806145b957607f821691505b6020821081036145d957634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052603260045260246000fd5b8082018082111561089d5761089d614453565b60006001820161461a5761461a614453565b5060010190565b6000808335601e1984360301811261463857600080fd5b8301803591506001600160401b0382111561465257600080fd5b602001915036819003821315612d1557600080fd5b6000808335601e1984360301811261467e57600080fd5b83016020810192503590506001600160401b0381111561469d57600080fd5b803603821315612d1557600080fd5b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b8183526000602080850194508260005b858110156144ce5781356146f881613baa565b6001600160a01b031687528183013583880152604096870196909101906001016146e5565b60208152813560208201526000602083013561473881613b85565b6001600160401b0380821660408501526147556040860186614667565b925060a0606086015261476c60c0860184836146ac565b92505061477c6060860186614667565b601f19808786030160808801526147948583856146ac565b945060808801359250601e198836030183126147af57600080fd5b602092880192830192359150838211156147c857600080fd5b8160061b36038313156147da57600080fd5b8685030160a0870152613a218482846146d5565b601f821115610f9657600081815260208120601f850160051c810160208610156148155750805b601f850160051c820191505b818110156135be57828155600101614821565b6001600160401b0383111561484b5761484b613be3565b61485f8361485983546145a5565b836147ee565b6000601f841160018114614893576000851561487b5750838201355b600019600387901b1c1916600186901b1783556148ed565b600083815260209020601f19861690835b828110156148c457868501358255602094850194600190920191016148a4565b50868210156148e15760001960f88860031b161c19848701351681555b505060018560011b0183555b5050505050565b6000808335601e1984360301811261490b57600080fd5b8301803591506001600160401b0382111561492557600080fd5b6020019150600681901b3603821315612d1557600080fd5b808202811582820484141761089d5761089d614453565b813561495f81613baa565b81546001600160a01b0319166001600160a01b03919091161781556020919091013560019190910155565b680100000000000000008311156149a3576149a3613be3565b805483825580841015614a115760016001600160ff1b0382811683146149cb576149cb614453565b80861686146149dc576149dc614453565b5060008381526020812086831b81019084841b015b80821015614a0c5782825582848301556002820191506149f1565b505050505b5060008181526020812083915b858110156135be57614a308383614954565b6040929092019160029190910190600101614a1e565b81358155600181016020830135614a5c81613b85565b6001600160401b038082166001600160401b0319845416178355614a836040860186614621565b93509150614a95838360028701614834565b614aa26060860186614621565b93509150614ab4838360038701614834565b60808501359250601e19853603018312614acd57600080fd5b918401918235915080821115614ae257600080fd5b506020820191508060061b3603821315614afb57600080fd5b611f6a81836004860161498a565b600060208284031215614b1b57600080fd5b81356001600160401b03811115614b3157600080fd5b8201601f81018413614b4257600080fd5b612c9b84823560208401613cdf565b8051613ba581613baa565b8051613ba581613bca565b6000614b75613ced84613cb8565b9050828152838383011115614b8957600080fd5b6113bc836020830184613ff1565b600082601f830112614ba857600080fd5b6113bc83835160208501614b67565b600082601f830112614bc857600080fd5b81516020614bd8613ced83613d3d565b82815260059290921b84018101918181019086841115614bf757600080fd5b8286015b84811015613dc4578051614c0e81613baa565b8352918301918301614bfb565b600060208284031215614c2d57600080fd5b81516001600160401b0380821115614c4457600080fd5b908301906101008286031215614c5957600080fd5b614c61613bf9565b614c6a83614b51565b8152614c7860208401614b51565b60208201526040830151604082015260608301516060820152614c9d60808401614b5c565b6080820152614cae60a08401614b5c565b60a082015260c083015182811115614cc557600080fd5b614cd187828601614b97565b60c08301525060e083015182811115614ce957600080fd5b614cf587828601614bb7565b60e08301525095945050505050565b6020815260006113bc6020830184614015565b600060208284031215614d2957600080fd5b81516113bc81613baa565b600060406001600160401b038516835260208181850152845160a083860152614d6060e0860182614015565b905081860151603f1980878403016060880152614d7d8383614015565b88860151888203830160808a01528051808352908601945060009350908501905b80841015614dd057845180516001600160a01b0316835286015186830152938501936001939093019290860190614d9e565b5060608901516001600160a01b031660a08901526080890151888203830160c08a01529550611ccf8187614015565b600082601f830112614e1057600080fd5b81356020614e20613ced83613d3d565b82815260069290921b84018101918181019086841115614e3f57600080fd5b8286015b84811015613dc45760408189031215614e5c5760008081fd5b614e64613c44565b8135614e6f81613baa565b81528185013585820152835291830191604001614e43565b600060a08236031215614e9957600080fd5b614ea1613c66565b82358152614eb160208401613b9a565b602082015260408301356001600160401b0380821115614ed057600080fd5b614edc36838701613d1d565b60408401526060850135915080821115614ef557600080fd5b614f0136838701613d1d565b60608401526080850135915080821115614f1a57600080fd5b50614f2736828601614dff565b60808301525092915050565b85815284602082015260a060408201526000614f5260a0830186614495565b6001600160a01b0394909416606083015250608001529392505050565b602081526000825160806020840152614f8b60a0840182614015565b905060018060a01b03602085015116604084015260408401516060840152606084015160808401528091505092915050565b600082614fda57634e487b7160e01b600052601260045260246000fd5b500490565b600060208284031215614ff157600080fd5b81516113bc81613bca565b600060018060a01b03808916835260c0602084015261501e60c0840189614015565b968116604084015260608301959095525091909216608082015260a0015292915050565b60006020828403121561505457600080fd5b81516001600160401b0381111561506a57600080fd5b8201601f8101841361507b57600080fd5b612c9b84825160208401614b67565b81516001600160401b038111156150a3576150a3613be3565b6150b7816150b184546145a5565b846147ee565b602080601f8311600181146150ec57600084156150d45750858301515b600019600386901b1c1916600185901b1785556135be565b600085815260208120601f198616915b8281101561511b578886015182559484019460019091019084016150fc565b50858210156151395787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b600060018060a01b0380871683526080602084015261516b6080840187614015565b94166040830152506060015292915050565b6000825161518f818460208701613ff1565b919091019291505056fea2646970667358221220fec6a70ecc9c43523d473214f3aecfe367b3a8573fc4667c63861855de262d9564736f6c63430008130033'
const providerOP = new ethers.JsonRpcProvider('https://twilight-icy-hill.optimism.quiknode.pro/00e108cda570cb6a6540966d1910fe0c97f60317')
const providerBase = new ethers.JsonRpcProvider('https://shy-winter-research.base-mainnet.quiknode.pro/4d981daee213a333f97659ffc446a24172504abe')
const providerETH = new ethers.JsonRpcProvider('https://frequent-orbital-sun.quiknode.pro/3907b8284628cd530cdbe2193ced8d16a82b85fc')
const providerArb = new ethers.JsonRpcProvider('https://intensive-red-meadow.arbitrum-mainnet.quiknode.pro/074030a299a42b87c8c041ec0e4b0a12931eb415')
const providerPolygon = new ethers.JsonRpcProvider('https://quaint-damp-haze.matic.quiknode.pro/91cb657425b4b6ad2a5054bfc1d9bf1167d17717')
const providerAvax = new ethers.JsonRpcProvider('https://sly-misty-forest.avalanche-mainnet.quiknode.pro/e42472c3938ba5f5fc49a4b78438de44caba7d59/ext/bc/C/rpc/')

console.log('Using wallet', new ethers.Wallet(PRIVATE_KEY, providerOP).address)

const deployParamsOP = {
    router: '0x3206695CaE29952f4b0c22a169725a865bc8Ce0f', // CCIP Router
    link: '0x350a791Bfc2C21F9Ed5d10980Dad2e2638ffa7f6',
    usdc: '0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85',
    v3Router: '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45', 
    v2Router: '0x4A7b5Da61326A6379179b40d00F57E5bbDC962c2',
    swapFee: 500,
}
const deployParamsBase = {
    router: '0x881e3A65B4d4a04dD529061dd0071cf975F58bCD', // CCIP Router
    link: '0x88Fb150BDc53A65fe94Dea0c9BA0a6dAf8C6e196',
    usdc: '0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913',
    v3Router: '0x2626664c2603336E57B271c5C0b26F421741e481', 
    v2Router: '0x4752ba5DBc23f44D87826276BF6Fd6b1C372aD24',
    swapFee: 500,
}
const deployParamsETH = {
    router: '0x80226fc0Ee2b096224EeAc085Bb9a8cba1146f7D', // CCIP Router
    link: '0x514910771AF9Ca656af840dff83E8264EcF986CA',
    usdc: '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48',
    v3Router: '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45', 
    v2Router: '0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D',
    swapFee: 500,
}
const deployParamsArb = {
    router: '0x141fa059441E0ca23ce184B6A78bafD2A517DdE8', // CCIP Router
    link: '0xf97f4df75117a78c1A5a0DBb814Af92458539FB4',
    usdc: '0xaf88d065e77c8cC2239327C5EDb3A432268e5831',
    v3Router: '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45', 
    v2Router: '0x4752ba5DBc23f44D87826276BF6Fd6b1C372aD24',
    swapFee: 500,
}
const deployParamsPolygon = {
    router: '0x849c5ED5a80F5B408Dd4969b78c2C8fdf0565Bfe', // CCIP Router
    link: '0xb0897686c545045aFc77CF20eC7A532E3120E0F1',
    usdc: '0x3c499c542cEF5E3811e1192ce70d8cC03d5c3359',
    v3Router: '0x68b3465833fb72A70ecDF485E0e4C7bD8665Fc45', 
    v2Router: '0xedf6066a2b290C185783862C7F4776A2C8077AD1',
    swapFee: 500,
}

const deployContracts = async () => {
    let signer = new ethers.Wallet(PRIVATE_KEY, providerOP)
    let ccipFactory = new ethers.ContractFactory(ccipAbi, bytecode, signer)
    deployParamsOP.feeReceiver = signer.address
    const ccipOP = await ccipFactory.deploy(...Object.values(deployParamsOP))
    console.log('CCIP OP Address', ccipOP.target)

    signer = new ethers.Wallet(PRIVATE_KEY, providerBase)
    ccipFactory = new ethers.ContractFactory(ccipAbi, bytecode, signer)
    deployParamsBase.feeReceiver = signer.address
    const ccipBase = await ccipFactory.deploy(...Object.values(deployParamsBase))
    console.log('CCIP Base Address', ccipBase.target)

    signer = new ethers.Wallet(PRIVATE_KEY, providerArb)
    ccipFactory = new ethers.ContractFactory(ccipAbi, bytecode, signer)
    deployParamsArb.feeReceiver = signer.address
    const ccipArb = await ccipFactory.deploy(...Object.values(deployParamsArb))
    console.log('CCIP ARB Address', ccipArb.target)

    signer = new ethers.Wallet(PRIVATE_KEY, providerPolygon)
    ccipFactory = new ethers.ContractFactory(ccipAbi, bytecode, signer)
    deployParamsPolygon.feeReceiver = signer.address
    const ccipPolygon = await ccipFactory.deploy(...Object.values(deployParamsPolygon))
    console.log('CCIP Polygon Address', ccipPolygon.target)

    signer = new ethers.Wallet(PRIVATE_KEY, providerETH)
    ccipFactory = new ethers.ContractFactory(ccipAbi, bytecode, signer)
    deployParamsETH.feeReceiver = signer.address
    const ccipETH = await ccipFactory.deploy(...Object.values(deployParamsETH))
    console.log('CCIP ETH Address', ccipETH.target)
}

const providers = [providerOP, providerBase, providerETH, providerArb, providerPolygon, providerAvax]
const chains = ['5009297550715157269', '3734403246176062136', '4949039107694359620', '4051577828743386545', '6433500567565415381', '15971525489660198786']
const contractsToSet = {
    op: '0x3b3b20C2E2Cf3d5FD42bf357DBDa2A8c755104f4',
    base: '0x19092fF8835E5598bF4C3a623350DA86201DF64c',
    eth: '0x7310d2E5eaA9FB79F1B81b806679667Fce6d24cA',
    arb: '0x4762324683921947a8318DF485eaA8C31De36961',
    polygon: '0x5A76d359Ca8e1c2251d88f2cf17bfb510f843909',
    providerAvax: '0xb6e071b9A009514673bAf37d81f666Cd983A9B1D',
}
const setAllowedChains = async () => {
    for (let a = 0; a < providers.length; a++) {
        const contractAddress = Object.values(contractsToSet)[a]
        const signer = new ethers.Wallet(PRIVATE_KEY, providers[a])
        const contract = new ethers.Contract(contractAddress, ccipAbi, signer)
        
        console.log('Setting up contract', contractAddress)
        for (let i = 0; i < chains.length; i++) {
            const chain = chains[i]
            console.log('Chain', chain)
            const tx1 = await contract.allowlistDestinationChain(chain, true)
            await tx1.wait()
            const tx2 = await contract.allowlistSourceChain(chain, true)
            await tx2.wait()
        }
    }
}

const setAllowedSenders = async () => {
    for (let a = 0; a < providers.length; a++) {
        const contractAddress = Object.values(contractsToSet)[a]
        const signer = new ethers.Wallet(PRIVATE_KEY, providers[a])
        const contract = new ethers.Contract(contractAddress, ccipAbi, signer)

        console.log('Setting up for contract', contractAddress)
        for (let i = 0; i < chains.length; i++) {
            const contractAddress2 = Object.values(contractsToSet)[i]
            console.log('-- Allowing sender', contractAddress2)
            const tx = await contract.allowlistSender(contractAddress2, true)
            await tx.wait()
        }
    }
}

// deployContracts()
// setAllowedChains()
setAllowedSenders()